import { describe, expect, test } from 'vitest';
import { proxy, request } from '../../../__tests__/utils';
describe('tunnel', () => {
    test('ok', async () => {
        proxy('http://test.whistlejs.com');
        proxy('http://tnl1.whistlejs.com');
        proxy('http://tnl2.whistlejs.com');
        proxy('http://tnl3.whistlejs.com');
        const r1 = await request('http://tnl4.whistlejs.com');
        const data = JSON.parse(r1.res.body);
        expect(r1.data.type).toBe('server');
        proxy('http://8080.tnl5.whistlejs.com');
        proxy('http://8080.tnl6.whistlejs.com');
        proxy('http://break.whistlejs.com', function (err) {
            expect(err).not.toBeUndefined();
        });
        proxy('http://ts.whistlejs.com/');
    });
});

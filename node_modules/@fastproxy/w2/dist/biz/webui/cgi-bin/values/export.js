"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const util_1 = require("../../../../lib/rules/util");
const util = tslib_1.__importStar(require("../util"));
function default_1(req, res) {
    let exportValues = req.query.values;
    try {
        exportValues = exportValues && JSON.parse(exportValues);
    }
    catch (e) {
        exportValues = null;
    }
    const result = {};
    util_1.values.list().forEach(function (file) {
        if (!exportValues || exportValues[file.name]) {
            result[file.name] = file.data;
        }
    });
    let filename = req.query.filename;
    if (filename && typeof filename === 'string') {
        if (!/\.(txt|json)/i.test(filename)) {
            filename += '.txt';
        }
    }
    else {
        filename = 'values_' + util.formatDate() + '.txt';
    }
    res.attachment(filename).send(JSON.stringify(result, null, '  '));
}
exports.default = default_1;
